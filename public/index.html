<!DOCTYPE html>
<html lang="en">
 <head>
   <meta charset="utf-8">
   <meta name="author" content="Martin Dessart">
   <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
   <title>Discover the place that rocks !</title>
   <!-- CSS links  -->
   <link rel="stylesheet" href="../src/app.css">
 </head>
 <body>
  <div id="root">
    <div class="container">
      <div class="options-box">
      <h1>FIND A CRAZY ROCKY PLACE</h1>
      <input id="hide-listings" type="button" value="Hide / Show Listing">
      </div>
      <div>
        <span class="list-text"> Search for an icelandic volcano !</span>
        <input id="research-text" type="text" placeholder="Ex: Kerlingarfjöll">
        <input id="research-input" type="button" value="Go">
        <ol id="list"> List of volcanoes</ol>
      </div>
    </div>
   <div id="map"></div>
  </div>
   <script>
   var map;
   var markers = [];
   var volcanoList = [];
   var volcan = document.getElementById('list');



   function initMap() {
       // Create the style of the map
       var styles = [
         {
             "featureType": "all",
             "elementType": "geometry",
             "stylers": [
                 {
                     "visibility": "off"
                 }
             ]
         },
         {
             "featureType": "all",
             "elementType": "geometry.fill",
             "stylers": [
                 {
                     "color": "#ff0000"
                 },
                 {
                     "saturation": "0"
                 }
             ]
         },
         {
             "featureType": "all",
             "elementType": "labels.text",
             "stylers": [
                 {
                     "visibility": "off"
                 }
             ]
         },
         {
             "featureType": "all",
             "elementType": "labels.icon",
             "stylers": [
                 {
                     "visibility": "off"
                 }
             ]
         },
         {
             "featureType": "administrative",
             "elementType": "labels.text.fill",
             "stylers": [
                 {
                     "color": "#444444"
                 }
             ]
         },
         {
             "featureType": "administrative.country",
             "elementType": "geometry.stroke",
             "stylers": [
                 {
                     "visibility": "on"
                 }
             ]
         },
         {
             "featureType": "administrative.province",
             "elementType": "geometry.fill",
             "stylers": [
                 {
                     "visibility": "on"
                 },
                 {
                     "saturation": "-62"
                 },
                 {
                     "color": "#ffffff"
                 }
             ]
         },
         {
             "featureType": "administrative.province",
             "elementType": "geometry.stroke",
             "stylers": [
                 {
                     "visibility": "on"
                 },
                 {
                     "color": "#000000"
                 },
                 {
                     "weight": "1.53"
                 }
             ]
         },
         {
             "featureType": "landscape",
             "elementType": "all",
             "stylers": [
                 {
                     "color": "#f2f2f2"
                 }
             ]
         },
         {
             "featureType": "landscape",
             "elementType": "geometry.fill",
             "stylers": [
                 {
                     "color": "#ffffff"
                 }
             ]
         },
         {
             "featureType": "landscape.man_made",
             "elementType": "all",
             "stylers": [
                 {
                     "visibility": "off"
                 }
             ]
         },
         {
             "featureType": "landscape.natural.landcover",
             "elementType": "geometry.fill",
             "stylers": [
                 {
                     "color": "#ff0000"
                 }
             ]
         },
         {
             "featureType": "poi",
             "elementType": "all",
             "stylers": [
                 {
                     "visibility": "off"
                 }
             ]
         },
         {
             "featureType": "road",
             "elementType": "all",
             "stylers": [
                 {
                     "saturation": -100
                 },
                 {
                     "lightness": 45
                 },
                 {
                     "visibility": "off"
                 }
             ]
         },
         {
             "featureType": "road",
             "elementType": "geometry.stroke",
             "stylers": [
                 {
                     "visibility": "off"
                 }
             ]
         },
         {
             "featureType": "road",
             "elementType": "labels.text",
             "stylers": [
                 {
                     "visibility": "off"
                 }
             ]
         },
         {
             "featureType": "road",
             "elementType": "labels.icon",
             "stylers": [
                 {
                     "visibility": "off"
                 }
             ]
         },
         {
             "featureType": "road.highway",
             "elementType": "all",
             "stylers": [
                 {
                     "visibility": "off"
                 }
             ]
         },
         {
             "featureType": "road.highway",
             "elementType": "labels",
             "stylers": [
                 {
                     "visibility": "off"
                 }
             ]
         },
         {
             "featureType": "road.arterial",
             "elementType": "labels.icon",
             "stylers": [
                 {
                     "visibility": "off"
                 }
             ]
         },
         {
             "featureType": "transit",
             "elementType": "all",
             "stylers": [
                 {
                     "visibility": "off"
                 }
             ]
         },
         {
             "featureType": "water",
             "elementType": "all",
             "stylers": [
                 {
                     "color": "#000000"
                 },
                 {
                     "visibility": "on"
                 }
             ]
         },
         {
             "featureType": "water",
             "elementType": "geometry.fill",
             "stylers": [
                 {
                     "color": "#000000"
                 }
             ]
         },
         {
             "featureType": "water",
             "elementType": "labels.icon",
             "stylers": [
                 {
                     "visibility": "off"
                 }
             ]
         }
      ];
      // Constructor creates a new map
      map = new google.maps.Map(document.getElementById('map'), {
         zoom: 6,
         center: {lat: 64.126, lng: -18.817},
         styles: styles,
         //mapTypeControl: false
       });

      var island = [
        {title: 'Eyjafjallajökull Volcano ', location: {lat: 63.63040460000001, lng: -19.606733299999973}},
        {title: 'Katla Volcano ', location: {lat: 63.6467299, lng: -19.130284699999947}},
        {title: 'Hverfjall Volcano ', location: {lat: 65.60861109999999, lng: -16.87166669999999}},
        {title: 'Kerlingarfjöll Volcano ', location: {lat: 64.6365932, lng: -19.26943959999994}},
        {title: 'Öræfajökull Volcano ', location: {lat: 63.98217380000001, lng: -16.653642799999943}},
        {title: 'Grímsnes Volcano ', location: {lat: 64.033333, lng: -20.866667000000007}},
        {title: 'Eldfell Volcano ', location: {lat: 63.4325, lng: -20.247499999999945}}
      ];

      var largeInfowindow = new google.maps.InfoWindow();

      //change marker color
      var defaultIcon = makeMarkerIcon('0091ff');
      var highlightedIcon = makeMarkerIcon('367f39');


      for (var i = 0; i < island.length; i++) {
        // Get the position from the location array
        var position = island[i].location;
        var title = island[i].title;
        // Create a marker per location, and put into markers array.
         var marker = new google.maps.Marker({
          position: position,
          title: title,
          animation: google.maps.Animation.DROP,
          icon: defaultIcon,
          id: i
        });
        markers.push(marker);
        console.log(marker.title);
        volcanoList.push(marker.title);
        var item = document.createElement("li");
        item.innerHTML=marker.title;
        console.log(item);
        volcan.appendChild(item);

        // Create an onclick event to open an infowindow at each marker.
        marker.addListener('click', function() {
          populateInfoWindow(this, largeInfowindow);
        });

        // to change the colors back and forth.
        marker.addListener('mouseover', function() {
          this.setIcon(highlightedIcon);
        });
        marker.addListener('mouseout', function() {
          this.setIcon(defaultIcon);
        });
      }
      // display markers
      for (var i = 0; i < markers.length; i++) {
        markers[i].setMap(map);
      };
  }

  document.getElementById('hide-listings').addEventListener('click', hideListings);

  document.getElementById('research-input').addEventListener('click', function() {
    researchVolc();
  });


  // displays content of the infoWindow
  function populateInfoWindow(marker, infowindow) {
    // Check to make sure the infowindow is not already opened on this marker.
    if (infowindow.marker != marker) {
      infowindow.marker = marker;
      infowindow.setContent('<div>' + marker.title + marker.position + '</div>');
      infowindow.open(map, marker);
      // Make sure the marker property is cleared if the infowindow is closed.
      infowindow.addListener('closeclick', function() {
        infowindow.marker = null;
      });
    }
  }

    // loop through the listings and hide them all.
    function hideListings() {
      for (var i = 0; i < markers.length; i++) {
        if (markers[i].map===map){
          markers[i].setMap(null);
        }
        else {
          markers[i].setMap(map);
        }
      }}

    //change marker color
    function makeMarkerIcon(markerColor) {
      var markerImage = new google.maps.MarkerImage(
        'http://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|'+ markerColor +
        '|40|_|%E2%80%A2',
        new google.maps.Size(21, 34),
        new google.maps.Point(0, 0),
        new google.maps.Point(10, 34),
        new google.maps.Size(21,34));
      return markerImage;
    }


    //Research function
    function researchVolc() {

    }



     </script>


     <script async defer
      src="https://maps.googleapis.com/maps/api/js?v=3&key=AIzaSyBjJdrQgRfSMEpE0_uW6ADz0DwPKoO_bEw&callback=initMap">
     </script>
 </body>
</html>
